{"componentChunkName":"component---src-templates-post-jsx","path":"/blog/top-atom-package/","result":{"data":{"site":{"siteMetadata":{"title":"Mike Upchurch","author":"Mike Upchurch"}},"markdownRemark":{"id":"0b5c2ebf-3958-5e72-bb09-452fbca971ea","excerpt":"This post is probably long overdue, but at the same time, it‚Äôs not, because I‚Äôve never written a blog post before. Nonetheless, I‚Äôd like to share my rather‚Ä¶","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/60e88872dcf95db2fc9d8ca3496a62fc/2a08f/spacey-meme.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEM0lEQVR42lWS609TdxjHT8/pKSBQdKIoVhc3Y9REh3KbQLi0XEovUG7lTnHJsCIOw2Ux1IoWgYqAzlUKQxiwAeKcDqebYcmmbsliYnxhtrgsvllMZjKzv+GznFPq9MU33+d5fs/zfS7nCMfrD5C6ZyNHGgo4VG3icKOVZqeJ7lYnHS0OclO2UZKzg2tDNpYGi5joyWVuoIz5cxUsDtewOFTBwkABs75CrvrtCEk7NyAIEofdrbhb22hta+fQBx/S1+/npPc0m7a8jVYUuRso5enNJp5928zzX/p48SjAy98WeP7rMH8uN/FosZ6pM1aElN3xvPPuTioqK7HabFiKi7CXlFHlrKahsYn09w+yTh/JSsDCs/tDvPxjmb8eBvnnyQx/P77CiydX+ff3L3myfIy5PgtCZtIWBEFg+2Y9m+NjVTtlTwKJ8TEk797CpvWxxEZHMNpl5OFcFQ+mnTxerObGSCln24yMeWw02pNI32ug1ZmsTLhRFTntzqbXbcSQsJbLJ/IpM+5iuyEBrSQTHSkz2lXM5RMFPP26lhvDJfjbC2mvy2DJX8Gsz8GVXgdBjxmh25VObXESc2dL+WmyiqM1aXhbsvmoNh1j2g7KTbsoN+1mfsDBxe4iZvusnO+w0NmUxViPlf6jJia9NlaC9cwPliLcDdbz81wL14YrWfSXMu1zcDtQw+c+B99cqOHBtIsJr42bo1Xcm3Jx6nA+na5sxj02rg2V09mUyRf9ZXwXqGNBEbw+UskPnzVz61IdI13FjHnsfD9Wy51ALbc+cXL702oCPRbcVam4SvZzrr2AoMfKuKeIkY5c7lxycOZINsfqDvLV+TKEW5eUzof4cdLFvalm7k+7WBlv4G6wgZXxOtWfOVtO4gY9+pgovC15LF+sYeKkhf42IwuDdi50FXCh28z1kTKEmT47QY8CG5d7QlDsEKxMeO34jxdwyp3DZK+dmb5Sxk/a1DNM9dq4+HGRmqP4414zgjljO7IsszY2iuioCBVxMZG8pV+jcuyaSJUT1sewPm4Na2Mj1dwwK7HoKJ36pxhTtiJkJSWqjkajQRA0qyyEoNEgihKSpH0V02hENS+EUEwURZUz9iUi5KUYVEeWJURNSDCcEKfXYzabyc3NIzMri2KzmX379q6KaJAkSWVZG2qYfcCAkJe6VXW0koioEVXB1yHrdGQe2EX6ezvR6SKIiNC92igMpVaJ5SQbEExpIUFZK4WmW50wnKy8bY6PI3HjutfW/l9MEkW1VhVUJsxP26Y6EToZ7eoKYUHFfuOm6iZatWlYWKnRyaGVc5Xz5SSHJ5RXi94UCH0oUW2iFCv3kkQJjSCqrKwbqVu94X4Dws0RC1OnTMz58pnw5DHhMTLpNXLFG+IZX776Nj9QyNI5M0v+Iq4OFjLry+eIM5XOpgzOuLPpaDzI4mAx/wF6Z48asN4fqgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"spacey meme\"\n        title=\"\"\n        src=\"/static/60e88872dcf95db2fc9d8ca3496a62fc/00d43/spacey-meme.png\"\n        srcset=\"/static/60e88872dcf95db2fc9d8ca3496a62fc/63868/spacey-meme.png 250w,\n/static/60e88872dcf95db2fc9d8ca3496a62fc/0b533/spacey-meme.png 500w,\n/static/60e88872dcf95db2fc9d8ca3496a62fc/00d43/spacey-meme.png 1000w,\n/static/60e88872dcf95db2fc9d8ca3496a62fc/2a08f/spacey-meme.png 1422w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>This post is probably long overdue, but at the same time, it‚Äôs not, because I‚Äôve never written a blog post before. Nonetheless, I‚Äôd like to share my rather accidental rise to OSS - Open Source <em>Stardom</em>. A metric that is, of course, measured in Github stars.</p>\n<p><a href=\"https://code.visualstudio.com/\">VSCode</a> usurped the <a href=\"https://atom.io\">Atom text editor</a> a while ago now, but there was a long point in time where <strong>if you wanted to compare two files, you had to go through me</strong>. Or, I don‚Äôt know, use another tool or something, I guess.</p>\n<h2>Up and Atom</h2>\n<p>I was introduced to Atom at my first full-time job. Within a few months of starting, I was pair programming with my team‚Äôs Tech Lead, and he showed me this new text editor he had set up to his liking.</p>\n<blockquote>\n<p>I installed these open source packages to improve my workflow, I can write my own JS snippets to do anything, <em>AND</em> I can style any part of the UI with CSS. - Mr. Tech Lead, 2015</p>\n</blockquote>\n<p>I could use skills I had already acquired to customize my work environment. Sold.</p>\n<p>Immediately, I changed themes and tried out packages and created JS snippets and wrote CSS. I could bend reality to my will - <a href=\"https://github.com/mupchrch/outline-selection#outline-selection---\">my power knew no bounds</a>. Yes, that was an outline/boundary pun about another package I wrote.</p>\n<p>After about a month, I realized a major issue in my workflow. I use MacOS at work. In order to compare two files, I would <strong>boot up a Windows VM</strong> just so I could use WinMerge. Kind of like taking a flight because I wanted some peanuts. This realization spurred me to try every single Atom package that dared to mention the words <code class=\"language-text\">compare</code>, <code class=\"language-text\">diff</code>, or <code class=\"language-text\">merge</code>. Nothing quite fit the bill.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 957px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5f76636301809df2b273e63a6141df9e/6bff2/package-search.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKklEQVR42o2SDW+CMBCG+ambUTaVgsy5OZP9WxdG+RZ1LR99l6uUEJVsl7y5Qq7PvXdg+fYCn+sNPlwfmwXDeu7gbcnw7njYuivsPF8/b9kK6+clnIcp2GQGNrHhTmywxxle5w523gu86ROsqqowVF3XOrdtC6VUn5XJSqFpGtzc62RhJIq8QMQ50iRBEsfIswwRjxAG3zifzmPXYJmu5MSI4lAU4GGIIs81NEtT8JDja79HeTjoGlNvGCTtkCyXZdmPQ6IzhbrjwtQRTAiBIAj0qrRD00kKgUrKHoQRkNHwnXHZA4meJqnW6XiElBLiR+juUshLlvIGet28H7mpa70jUswjxNFF9FEo084IfA94DbdMEbnU6n4dUtPloYO/wvpP0dDBvVGHwF+hhPIY4/YRrwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"My very real search for a side-by-side comparison package.\"\n        title=\"\"\n        src=\"/static/5f76636301809df2b273e63a6141df9e/6bff2/package-search.png\"\n        srcset=\"/static/5f76636301809df2b273e63a6141df9e/63868/package-search.png 250w,\n/static/5f76636301809df2b273e63a6141df9e/0b533/package-search.png 500w,\n/static/5f76636301809df2b273e63a6141df9e/6bff2/package-search.png 957w\"\n        sizes=\"(max-width: 957px) 100vw, 957px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">My very real search for a side-by-side comparison package.</figcaption>\n  </figure></p>\n<h2>Hacking the ‚Äúhackable text editor‚Äù</h2>\n<p>I was floored. How could this free product that just exited Beta not provide exactly what I need? No matter, it should be easy enough to build. I went into research mode. I found a <a href=\"https://stackoverflow.com/a/1313218\">StackOverflow post</a>, which pointed me to a research paper titled <a href=\"http://www.xmailserver.org/diff2.pdf\">An O(ND) Difference Algorithm and its Variations</a>. My eyes glazed over. This was out of my wheelhouse - I could barely vertically align text in a <code class=\"language-text\">&lt;div></code>.</p>\n<p>But wait, I‚Äôve seen websites where you can paste in the contents of two files that you want to compare. How do they do it? Hold on, what is <a href=\"https://github.com/kpdecker/jsdiff\">jsdiff</a>? <em>Some poor soul already did the dirty work!</em> üéâ</p>\n<p>I followed Atom‚Äôs documentation and slapped together a very bare-bones package. At that time, packages were built using <a href=\"https://coffeescript.org/\">CoffeeScript</a>, so I stumbled a bit in the beginning. To be honest, I never fully boarded the CoffeeScript train (and I eventually refactored much of the supporting logic to JavaScript files), but I can appreciate its successful influence on <a href=\"https://www.w3schools.com/js/js_es6.asp\">ES6</a>.</p>\n<p>Regarding my new package, <a href=\"https://github.com/mupchrch/split-diff/commit/59b0676dfa5b53d900ec8fde1c6b833941ffd8c5\">things started out slow</a>, but I persevered:</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 881px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/15ba18dea388e6e926c458cd78abdafd/96658/important-commit.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 5.6000000000000005%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAM0lEQVR42nXBiwkAIAgFwPafM31mEEkUfYSaoLvAEGIgadLMkEioZmsud78fY3ppu/bzAL04OYIUaDo1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"The first commit to show signs of life.\"\n        title=\"\"\n        src=\"/static/15ba18dea388e6e926c458cd78abdafd/96658/important-commit.png\"\n        srcset=\"/static/15ba18dea388e6e926c458cd78abdafd/63868/important-commit.png 250w,\n/static/15ba18dea388e6e926c458cd78abdafd/0b533/important-commit.png 500w,\n/static/15ba18dea388e6e926c458cd78abdafd/96658/important-commit.png 881w\"\n        sizes=\"(max-width: 881px) 100vw, 881px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">The first commit to show signs of life.</figcaption>\n  </figure></p>\n<p>Cool, I‚Äôm done. That was quick and easy‚Ä¶ Except everything gets misaligned if the number of lines added doesn‚Äôt equal the number of lines removed! I needed some way to insert ‚Äúfake lines‚Äù, so related differences remained properly aligned. The only issue was, at the time, there was <em>zero</em> support for what eventually became ‚Äúblock decorations‚Äù.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6481630553d43395eaa341f0384cf66e/c587f/no-block-decorations.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.199999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACGklEQVR42m2TW4vTQBTH84F6yXUm92SSTJK22V6p210qdbsuiMrigyC+Cwo++oH/ck7SFsGHH2cmmTm3/xnDiwtMvIyZihxeWMANC5gi5z3hhBXsoOQ1nxU5TKlg+cV1T9hhCcOLG1h+BTeqYcoCllR8uL/cX4yrJayghBVUcELN/0zRn7PIkjO/hGq3MCi6FWo+aAcVJoKc3bD9Aqqs0ak5XteP+Hr/hM+rB3y4e4Pn2Q7Heo2jXuGx2aDUaxj2ENmNNGfUk7EduynbuGhxqhf4c3/G78MZv/Yn/Nyf8GN3xPflAd9WB3zp9lDlEgal7asOWb1BkM/hxTVj+eW1BSJboMsX+Djb4p1e4dys8dJu8NJs8J5oNzg1aySqg0EZULle0rIjkdRwY81rypraIJIWblBCRDVD/bJlcYX66AQVQnJIGTpRBdMfhBBZD5edYipJvQpTWUCqDolegYR0KBgJJAuMvYwhYY183uHt6xnHT0/YPz+ie9j9w91hi0wvYMoSImng5wvItIFIqIqKv3mR5gxlOoNh+Qoel1kxdlBcsdgqqKrmORx7OUZDNrTuyfjbRCokpPLUy2EFGjZFCSsudeSkGBNuipGTwZEx0jhHFNaIgvK/BH7BI2ZQ30hRcnYb6FsPyZJj21dwQ83iELagoc5hD5jDS2NR3Ljl+unFXMbl8lIuAUy/hEuTkM7gxg2LMRlKvljy9Rcjt59Q4GWMwAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Something isn&#39;t quite lining up here...\"\n        title=\"\"\n        src=\"/static/6481630553d43395eaa341f0384cf66e/00d43/no-block-decorations.png\"\n        srcset=\"/static/6481630553d43395eaa341f0384cf66e/63868/no-block-decorations.png 250w,\n/static/6481630553d43395eaa341f0384cf66e/0b533/no-block-decorations.png 500w,\n/static/6481630553d43395eaa341f0384cf66e/00d43/no-block-decorations.png 1000w,\n/static/6481630553d43395eaa341f0384cf66e/aa440/no-block-decorations.png 1500w,\n/static/6481630553d43395eaa341f0384cf66e/c587f/no-block-decorations.png 1863w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Something isn&#39;t quite lining up here...</figcaption>\n  </figure></p>\n<p>From the eventual block decorations announcement post:</p>\n<blockquote>\n<p>Users and package authors have come up with hacks that circumvent the problem by monkey-patching DisplayBuffer and the way it constructs tokenized lines.</p>\n</blockquote>\n<p>Guilty üôã‚Äç‚ôÇÔ∏è</p>\n<p>After 3 days of bashing my head against my keyboard, I finally did it. Just kidding, I took some <a href=\"https://github.com/mupchrch/split-diff/blob/9e71b0c53811460d041fa71ab9e5db8820ad61e0/lib/build-lines-helper.js#L5\"><del>slight</del> heavy influence</a> from a package that Facebook released called Nuclide. Consider me the Robin Hood of side-by-side file comparison.</p>\n<p>I also realized how massive of a pain it is to have to scroll both editors separately. Again, <a href=\"https://github.com/mupchrch/split-diff/blob/e24b345715b6af26536af59864182c5944a809b8/lib/sync-scroll.js#L5\">I <del>stole</del> borrowed a file</a> from Nuclide, and now the editors‚Äô scroll positions were in sync at all times.</p>\n<p><img src=\"/c0933ec7a67141c11639679af57386db/sync-scroll.gif\" alt=\"Block decorations are working, as is synchronized scrolling!\"></p>\n<h2>Hello, World!</h2>\n<p>I named this thing <a href=\"https://github.com/mupchrch/split-diff#split-diff---\">split-diff</a> and shipped v0.1.0.</p>\n<p>I couldn‚Äôt believe the kind of traction it gained. Something I had created for myself, slowly but surely started racking up a not insignificant amount of downloads. 1,000‚Ä¶ 10,000‚Ä¶ 100,000‚Ä¶ 500,000‚Ä¶ and eventually near the end of Atom‚Äôs life - <strong>1,000,000 downloads</strong> üò±</p>\n<p>However, let‚Äôs not celebrate too soon. Far before all that, myself, and <a href=\"https://github.com/mupchrch/split-diff/issues/6#issuecomment-211070405\">at least one person in my growing userbase</a>, had run into a problem: Diffing large files <strong>completely froze Atom</strong>.</p>\n<p>I did some research (the Atom API documentation was fantastic) and found my solution: <code class=\"language-text\">BufferedNodeProcess</code>. This is pretty much what it sounds like ‚Äî I could run arbitrary JavaScript in a separate Node.js process, write its output to the buffer, and parse it back in the main thread. This freed up Atom to continue actually functioning while I computed the diff results asynchronously. <em>More importantly</em>, I could display a loading indicator if the diff was taking longer than 1 second. <em>MORE importantly</em>, the user now had the choice to be able to cancel out of this painfully slow package, and even proceed to uninstall it!</p>\n<h2>Goodbye, World!</h2>\n<p>Addressing the UI lockup was what I consider the last interesting issue that I fixed. Although I did go on to add quite a few more features:</p>\n<ul>\n<li>Moving to the next/previous diff ‚Äúchunk‚Äù</li>\n<li>Quickly moving a ‚Äúchunk‚Äù of changes from one editor to the other</li>\n<li>A bottom bar in the UI to show the number of differences and also provide easy buttons for the aforementioned features</li>\n<li>Highlighting which words changed between each line</li>\n<li>Diffing with the previous git commit (if available)</li>\n</ul>\n<p><img src=\"/73ce6380faddcf40b2acd025a9fea6a1/additional-features.gif\" alt=\"Using the UI bar to move between diffs and copy one to the other editor, then demonstrating live editing.\"></p>\n<p>Looking back with my current experience level, there was still a lot of performance to be gained. No dig at <code class=\"language-text\">jsdiff</code>, but it might have been a better idea to call a C/C++ module using the <code class=\"language-text\">BufferedProcess</code> API. I also always wanted to just use the info from <code class=\"language-text\">git diff</code> if it was available, but never had the time or ambition to add another fork in the code.</p>\n<p>I‚Äôll end this post by sharing the best moment to come out of <code class=\"language-text\">split-diff</code>. At work, we had started hearing rumors that my company was thinking of creating an internal Atom package to help our frontend engineers with some development pain points. My team‚Äôs Tech Lead (the same one who had introduced me to Atom), was included on a demo of the new package. He noticed the package could compare files‚Ä¶ and <strong>it installed <code class=\"language-text\">split-diff</code> to do it</strong>.</p>\n<blockquote>\n<p>Wait you guys know Mike made that package, right?!</p>\n</blockquote>\n<p>I had poured countless hours into fixing bugs and creating features. I never expected any money or notoriety - I was doing it for free and for fun. Strangely, I was even yelled when things broke. But as it turns out, it literally ended up paying off. That coincidence at work helped advance my career on more than one occasion.</p>","frontmatter":{"title":"split-diff: How I fumbled my way to a top Atom package","date":"May 20, 2023","description":null}}},"pageContext":{"slug":"/blog/top-atom-package/","previous":null,"next":null,"isBlog":true}},"staticQueryHashes":["3296784666","63159454"],"slicesMap":{}}